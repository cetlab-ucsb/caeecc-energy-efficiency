---
title: "Grouped/Ungrouped Regressions with ln(population) to account for skew"
output: html_notebook
---

```{r}
library("dplyr")
cities <- read.csv('C:/Users/ather/CS Projects/CETLab/caeecc-energy-efficiency/cities_2.csv')
```

```{r}
#create ln_pop variable as ln(total_population)

cities$ln_pop = log(cities$total_population)
hist(cities$ln_pop)

#group data by ln_pop
cities_lnq1 <- subset(cities, ln_pop < 9.5)
cities_lnq2 <- subset(cities, ln_pop >= 9.5 & ln_pop < 11.5)
cities_lnq3 <- subset(cities, ln_pop >= 11.5 & ln_pop < 12.5)
cities_lnq4 <- subset(cities, ln_pop > 12.5)

```


```{r}
#group information (count, means/ranges, visualization)
count(cities_lnq1)
count(cities_lnq2)
count(cities_lnq3)
count(cities_lnq4)

summary(cities_lnq1$total_population)
summary(cities_lnq2$total_population)
summary(cities_lnq3$total_population)
summary(cities_lnq4$total_population)

hist(cities_lnq1$total_population)
hist(cities_lnq2$total_population)
hist(cities_lnq3$total_population)
hist(cities_lnq4$total_population)
```

```{r}
#regressions on groups

lm(Budget ~ total_population + Total.Claims + Total.Tax.Revenue + Total.Programs + ces_score_median + TotalFirstYearGrosskWh, data = cities_lnq1)
lm(Budget ~ total_population + Total.Claims + Total.Tax.Revenue + Total.Programs + ces_score_median + TotalFirstYearGrosskWh, data = cities_lnq2)
lm(Budget ~ total_population + Total.Claims + Total.Tax.Revenue + Total.Programs + ces_score_median + TotalFirstYearGrosskWh, data = cities_lnq3)
lm(Budget ~ total_population + Total.Claims + Total.Tax.Revenue + Total.Programs + ces_score_median + TotalFirstYearGrosskWh, data = cities_lnq4)

```

```{r}
#regression ungrouped data with ln_pop

lm(Budget ~ ln_pop + Total.Tax.Revenue + ces_score_median + median_household_income_usd + dac_proportion + ruca_average, data = cities)

```

```{r}
#regression ungrouped data with unchanged total_population

lm(Budget ~ total_population + Total.Tax.Revenue + ces_score_median + median_household_income_usd + dac_proportion + ruca_average, data = cities)

```

